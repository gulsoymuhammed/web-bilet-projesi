@{
    ViewBag.Title = "Other Page";
    ViewData["Title"] = "Other Page";
}

<link rel="stylesheet" href="~/Content/css/Seat.css">

<h2>Other Page</h2>

<p>Seçilen Tarih: <span id="selectedDateDisplay"></span></p>
<p>Seçilen Etkinlik: <span id="selectedEtkinlikDisplay"></span></p>
<p>Seçilen Etknilik Adı: <span id="selectedSehirDisplay"></span></p>
<p>Seçilen Şehir: <span id="selectedBranchDisplay"></span></p>
<p>Seçilen Salon: <span id="selectedDepartmentDisplay"></span></p>
<p>Seçilen Saat: <span id="selectedTimeDisplay"></span></p>

<h2>Cinema Seat Selection</h2>

<div class="movie-container">
    <ul class="showcase">
        <li>
            <div class="seat"></div>
            <small>N/A</small>
        </li>
        <li>
            <div class="seat selected"></div>
            <small>Selected</small>
        </li>
        <li>
            <div class="seat occupied"></div>
            <small>Occupied</small>
        </li>
    </ul>

    <div class="container">
        <div class="screen"></div>

        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
        </div>
        <div class="row">
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
            <div class="seat occupied"></div>
            <div class="seat"></div>
        </div>

        <!-- Add more rows and seats as needed -->

        <p class="text">
            You have selected <span id="count">0</span> seats
        </p>
    </div>
</div>



<a href="@Url.Action("Payment", "Home")" id="continueButton" style="display:none">Continue to Payment</a>

<script>

    const continueButton = document.getElementById('continueButton');

    // Get values from localStorage
    var selectedDate = localStorage.getItem('selectedDate');
    var selectedEtkinlik = localStorage.getItem('selectedEtkinlik');
    var selectedSehir = localStorage.getItem('selectedSehir');
    var selectedBranch = localStorage.getItem('selectedBranch');
    var selectedDepartment = localStorage.getItem('selectedDepartment');
    var selectedTime = localStorage.getItem('selectedTime');

    // Display the values in HTML
    document.getElementById('selectedDateDisplay').innerText = selectedDate;
    document.getElementById('selectedEtkinlikDisplay').innerText = selectedEtkinlik;
    document.getElementById('selectedSehirDisplay').innerText = selectedSehir;
    document.getElementById('selectedBranchDisplay').innerText = selectedBranch;
    document.getElementById('selectedDepartmentDisplay').innerText = selectedDepartment;
    document.getElementById('selectedTimeDisplay').innerText = selectedTime;

    // Log the values to the console for debugging
    console.log('selectedDate:', selectedDate);
    console.log('selectedEtkinlik:', selectedEtkinlik);
    console.log('selectedSehir:', selectedSehir);
    console.log('selectedBranch:', selectedBranch);
    console.log('selectedDepartment:', selectedDepartment);
    console.log('selectedTime:', selectedTime);

    const container = document.querySelector('.container');

    const count = document.getElementById('count');


    const seats = document.querySelectorAll('.row .seat:not(.occupied)');

    // Otomatik olarak ID atama
    seats.forEach((seat, index) => {
        seat.setAttribute('id', `seat-${index + 1}`);
    });

    function updateSelectedCount() {
        const selectedSeats = document.querySelectorAll('.row .seat.selected');
        const selectedSeatsCount = selectedSeats.length;
        count.innerText = selectedSeatsCount;

        // Remove local storage entry for unselected seats
        const unselectedSeats = document.querySelectorAll('.row .seat:not(.selected)');
        unselectedSeats.forEach(seat => {
            const seatId = seat.getAttribute('id');
            localStorage.removeItem(seatId);
        });

        // Log the IDs of selected seats to the console
        const selectedSeatIds = Array.from(selectedSeats).map(seat => {
            return seat.getAttribute('id');
        });
        console.log('Selected Seat IDs:', selectedSeatIds);

        selectedSeatIds.forEach(seatId => {
            localStorage.setItem(seatId, 'selected');
        });

        continueButton.style.display = selectedSeatsCount > 0 ? 'block' : 'none';
    }



    // Seat click event
    container.addEventListener('click', e => {
        if (e.target.classList.contains('seat') &&
            !e.target.classList.contains('occupied')) {
            e.target.classList.toggle('selected');
        }
        updateSelectedCount();
    });
</script>
